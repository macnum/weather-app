import"./styles/main.css";import DOM from"./dom.js";import{toggleUnit}from"./utils.js";const toggleBtn=document.querySelector(".toggle-unit"),searchForm=document.querySelector("#myWeatherForm"),weatherBaseURL="https://weather.visualcrossing.com/VisualCrossingWebServices/rest/services/timeline/",weatherApiKey="UBGBWDQ2ZLTQ82XEXWCNB7QC9",mainContainer=document.querySelector(".main-container"),loader=document.querySelector(".loader");async function weatherApp(e,t){console.log("requestData");const o=checkUrlParameters(e,t);if(!o)return;const r=await getData(o);hideLoader(),DOM.renderData(r)}function showLoader(){loader.classList.remove("hidden"),mainContainer.classList.add("hidden")}function hideLoader(){loader.classList.add("hidden"),mainContainer.classList.remove("hidden")}function checkUrlParameters(e,t){const o=(new Date).toISOString().split("T")[0];return e&&t?`${weatherBaseURL}${e}/${o}/${t}?key=${weatherApiKey}`:e?`${weatherBaseURL}${e}?key=${weatherApiKey}`:""}async function getData(e){try{showLoader();const t=await fetch(e,{method:"GET"});if(!t.ok)throw new Error(`Response status: ${t.status}`);const o=await t.json();return console.log(o),o}catch(e){console.error(e.message)}finally{hideLoader()}}document.addEventListener("DOMContentLoaded",()=>{weatherApp("lagos")}),searchForm.addEventListener("submit",e=>{const t=document.querySelector("#search");console.log("FORM SUBMITTED"),e.preventDefault();const o=t.value.toLowerCase().trim();o&&weatherApp(o)}),toggleBtn.addEventListener("click",e=>{toggleUnit(),DOM.updateData()});